<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<title>YouTube Tycoon ULTIMATE v3.0</title>
<style>
  /* ========== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ========== */
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    color: white;
    min-height: 100vh;
    padding: 10px;
    overflow-x: hidden;
  }
  .container { max-width: 1600px; margin: 0 auto; }

  /* ========== –≠–ö–†–ê–ù–´ ========== */
  .screen { display: none; }
  .screen.active { display: block; animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(50px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }

  /* ========== –°–¢–ê–†–¢–û–í–´–ô –≠–ö–†–ê–ù ========== */
  #startScreen {
    background: linear-gradient(135deg, #FF0000 0%, #CC0000 100%);
    padding: 60px 40px;
    border-radius: 25px;
    box-shadow: 0 0 60px rgba(255,0,0,0.6);
    margin-top: 40px;
    text-align: center;
  }
  #startScreen h1 { font-size: 52px; margin-bottom: 25px; text-shadow: 3px 3px 6px rgba(0,0,0,0.7); }
  #startScreen input {
    width: 100%;
    padding: 18px;
    font-size: 24px;
    border-radius: 12px;
    border: none;
    margin: 15px 0;
    text-align: center;
    background: rgba(255,255,255,0.95);
    color: #000;
  }
  #startScreen .niche-selector {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 25px;
    margin: 35px 0;
  }
  #startScreen .niche-card {
    background: rgba(0,0,0,0.4);
    padding: 35px 20px;
    border-radius: 18px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 3px solid transparent;
  }
  #startScreen .niche-card:hover { transform: scale(1.08) translateY(-5px); box-shadow: 0 8px 30px rgba(255,0,0,0.4); }
  #startScreen .niche-card.selected { border-color: #fff; background: rgba(255,255,255,0.15); }
  #startScreen .btn {
    background: #fff;
    color: #FF0000;
    padding: 20px 45px;
    font-size: 26px;
    font-weight: bold;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    margin: 12px;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }
  #startScreen .btn:hover { transform: scale(1.07); box-shadow: 0 6px 25px rgba(255,255,255,0.4); }

  /* ========== –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù ========== */
  .game-header {
    background: linear-gradient(135deg, #FF0000 0%, #990000 100%);
    padding: 20px 30px;
    border-radius: 18px;
    margin-bottom: 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 5px 20px rgba(255,0,0,0.3);
  }
  .vibe-meter {
    width: 100%;
    height: 22px;
    background: #2a2a2a;
    border-radius: 11px;
    margin: 12px 0;
    overflow: hidden;
    box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
  }
  .vibe-fill {
    height: 100%;
    background: linear-gradient(90deg, #FFD700, #FFA500, #FF6347);
    width: 100%;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 10px rgba(255,215,0,0.5);
  }

  /* ========== –¢–ê–ë–´ ========== */
  .tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 25px;
    overflow-x: auto;
  }
  .tab {
    flex: 1;
    min-width: 120px;
    padding: 15px 20px;
    background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
    border-radius: 12px;
    cursor: pointer;
    text-align: center;
    font-weight: bold;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .tab.active { background: linear-gradient(135deg, #FF0000, #CC0000); box-shadow: 0 0 20px rgba(255,0,0,0.4); }

  /* ========== –ö–û–ù–¢–ï–ù–¢ –¢–ê–ë–û–í ========== */
  .tab-content { display: none; }
  .tab-content.active { display: block; animation: slideIn 0.4s; }
  @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }

  /* ========== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ========== */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 25px 0;
  }
  .stat-card {
    background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
    padding: 30px;
    border-radius: 18px;
    border: 2px solid #FF0000;
    transition: all 0.3s;
  }
  .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(255,0,0,0.2); }
  .stat-title { font-size: 14px; color: #aaa; text-transform: uppercase; letter-spacing: 1px; }
  .stat-value { font-size: 42px; font-weight: bold; color: #FF0000; margin: 10px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }

  /* ========== –£–õ–£–ß–®–ï–ù–ò–Ø ========== */
  .upgrades-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    margin: 25px 0;
  }
  .upgrade-card {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    padding: 25px;
    border-radius: 16px;
    border: 2px solid #444;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }
  .upgrade-card:hover { border-color: #FF0000; transform: translateY(-8px); box-shadow: 0 15px 40px rgba(255,0,0,0.3); }
  .upgrade-name { font-size: 20px; font-weight: bold; margin-bottom: 10px; }
  .upgrade-desc { font-size: 14px; color: #aaa; margin-bottom: 15px; line-height: 1.5; }
  .upgrade-stats { font-size: 13px; color: #00FF00; margin-bottom: 15px; }
  .upgrade-btn {
    background: linear-gradient(135deg, #FF0000, #CC0000);
    color: white;
    border: none;
    padding: 14px 25px;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    transition: all 0.2s;
  }
  .upgrade-btn:hover { transform: scale(1.02); }
  .upgrade-btn:disabled { background: #555; cursor: not-allowed; }

  /* ========== –°–û–¢–†–£–î–ù–ò–ö–ò ========== */
  .staff-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
    margin: 25px 0;
  }
  .staff-card {
    background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
    padding: 25px;
    border-radius: 16px;
    border-left: 6px solid #00FF00;
    transition: all 0.3s;
  }
  .staff-card:hover { transform: translateX(5px); }
  .staff-fatigue {
    background: #222;
    height: 12px;
    border-radius: 6px;
    margin-top: 15px;
    overflow: hidden;
  }
  .staff-fatigue-fill {
    height: 100%;
    background: linear-gradient(90deg, #00FF00, #FFD700, #FF0000);
    width: 100%;
    transition: width 0.5s;
  }

  /* ========== –ì–†–ê–§–ò–ö–ò ========== */
  canvas {
    width: 100% !important;
    height: 300px !important;
    background: #0a0a0a;
    border-radius: 15px;
    margin: 20px 0;
    box-shadow: 0 5px 20px rgba(0,0,0,0.5);
  }

  /* ========== –°–û–ë–´–¢–ò–Ø ========== */
  .event-log {
    background: rgba(0,0,0,0.4);
    padding: 20px;
    border-radius: 15px;
    max-height: 250px;
    overflow-y: auto;
    margin-top: 25px;
  }
  .event {
    padding: 12px;
    margin: 8px 0;
    border-left: 5px solid #FF0000;
    background: #1a1a1a;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s;
  }
  .event:hover { background: #2a2a2a; }
  .event.success { border-left-color: #00FF00; }
  .event.fail { border-left-color: #FF0000; }
  .event.warning { border-left-color: #FFD700; }
  .event.viral { border-left-color: #FF00FF; }

  /* ========== –ú–ò–°–°–ò–ò ========== */
  .missions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 15px;
    margin: 20px 0;
  }
  .mission-card {
    background: linear-gradient(135deg, #2a2a2a, #3a3a3a);
    padding: 20px;
    border-radius: 12px;
    border: 2px solid #444;
  }
  .mission-card.completed { border-color: #00FF00; opacity: 0.7; }
  .mission-progress {
    background: #333;
    height: 10px;
    border-radius: 5px;
    margin: 10px 0;
    overflow: hidden;
  }
  .mission-progress-fill {
    height: 100%;
    background: #00FF00;
    transition: width 0.5s;
  }

  /* ========== –°–ü–û–ù–°–û–†–´ ========== */
  .sponsor-card {
    background: linear-gradient(135deg, #FFD700, #FFA500);
    color: #000;
    padding: 20px;
    border-radius: 12px;
    margin: 10px 0;
    cursor: pointer;
    transition: all 0.3s;
  }
  .sponsor-card:hover { transform: scale(1.02); }

  /* ========== –¢–û–ü ========== */
  .top-list {
    max-height: 500px;
    overflow-y: auto;
  }
  .top-entry {
    background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
    padding: 18px;
    margin: 8px 0;
    border-radius: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s;
  }
  .top-entry:hover { background: #2a2a2a; }
  .top-entry.me { border: 3px solid #FFD700; box-shadow: 0 0 20px rgba(255,215,0,0.5); }

  /* ========== –ù–ê–°–¢–†–û–ô–ö–ò ========== */
  .toggle-switch {
    width: 60px;
    height: 30px;
    background: #444;
    border-radius: 15px;
    position: relative;
    cursor: pointer;
    transition: background 0.3s;
  }
  .toggle-switch.active { background: #00FF00; }
  .toggle-switch::after {
    content: '';
    width: 26px;
    height: 26px;
    background: white;
    border-radius: 50%;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: left 0.3s;
  }
  .toggle-switch.active::after { left: 32px; }

  /* ========== –°–ö–†–û–õ–õ–ë–ê–† ========== */
  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-track { background: #1a1a1a; }
  ::-webkit-scrollbar-thumb { background: #FF0000; border-radius: 4px; }
</style>
</head>
<body>
<div class="container">

  <!-- ========== –°–¢–ê–†–¢–û–í–´–ô –≠–ö–†–ê–ù ========== -->
  <div id="startScreen" class="screen active">
    <h1>üì∫ YouTube Tycoon <span style="color: #FFD700;">ULTIMATE</span></h1>
    <input type="text" id="channelInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∫–∞–Ω–∞–ª–∞..." maxlength="30">
    <div id="nameError" style="color: #FF6B6B; margin: 10px 0; display: none;"></div>
    
    <h2 style="margin: 30px 0;">üéØ –í—ã–±–µ—Ä–∏—Ç–µ –Ω–∏—à—É:</h2>
    <div class="niche-selector" id="nicheSelector"></div>
    
    <div style="margin: 40px 0;">
      <button class="btn" onclick="createChannel()">üöÄ –°–û–ó–î–ê–¢–¨ –ö–ê–ù–ê–õ</button>
      <button class="btn" onclick="showTopChannels()" style="background: #444;">üèÜ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü</button>
      <button class="btn" onclick="resetAll()" style="background: #800;">üí£ –°–ë–†–û–° –í–°–ï–ì–û</button>
    </div>
    
    <div style="font-size: 12px; color: #aaa; margin-top: 30px;">
      üíæ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã | üìä 60 FPS | üéÆ –í–µ—Ä—Å–∏—è 3.0
    </div>
  </div>

  <!-- ========== –≠–ö–†–ê–ù –¢–û–ü–ê ========== -->
  <div id="topScreen" class="screen">
    <h2 style="color: #FFD700; margin-bottom: 20px;">üèÜ –ì–õ–û–ë–ê–õ–¨–ù–´–ô –¢–û–ü 100</h2>
    <div class="top-list" id="globalTopList"></div>
    <button class="btn" onclick="showScreen('startScreen')" style="background: #444;">‚Üê –ù–∞–∑–∞–¥</button>
  </div>

  <!-- ========== –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù ========== -->
  <div id="gameScreen" class="screen">
    <!-- –•–ï–î–ï–† -->
    <div class="game-header">
      <div>
        <strong id="channelDisplay" style="font-size: 24px;">–ö–∞–Ω–∞–ª</strong>
        <div class="vibe-meter">
          <div class="vibe-fill" id="vibeDisplay"></div>
        </div>
        <small>–≠–Ω–µ—Ä–≥–∏—è: <span id="energyDisplay">100</span>% | –î–µ–Ω—å: <span id="dayDisplay">1</span></small>
      </div>
      <div style="text-align: right;">
        <button onclick="showSettings()" style="background: #444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 2px;">‚öôÔ∏è</button>
        <button onclick="saveManual()" style="background: #00FF00; color: #000; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 2px;">üíæ</button>
        <button onclick="resetGame()" style="background: #800; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 2px;">üîÑ</button>
      </div>
    </div>

    <!-- –¢–ê–ë–´ -->
    <div class="tabs">
      <div class="tab active" onclick="switchTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</div>
      <div class="tab" onclick="switchTab('upgrades')">üõ†Ô∏è –ê–ø–≥—Ä–µ–π–¥—ã</div>
      <div class="tab" onclick="switchTab('staff')">üë• –ö–æ–º–∞–Ω–¥–∞</div>
      <div class="tab" onclick="switchTab('analytics')">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</div>
      <div class="tab" onclick="switchTab('missions')">üéØ –ú–∏—Å—Å–∏–∏</div>
      <div class="tab" onclick="switchTab('sponsors')">üí∞ –°–ø–æ–Ω—Å–æ—Ä—ã</div>
      <div class="tab" onclick="switchTab('prestige')">‚ú® –ü—Ä–µ—Å—Ç–∏–∂</div>
    </div>

    <!-- –î–ê–®–ë–û–†–î -->
    <div id="dashboardTab" class="tab-content" style="display: block;">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-title">üë• –ü–æ–¥–ø–∏—Å—á–∏–∫–∏</div>
          <div class="stat-value" id="subsValue">0</div>
          <small>+<span id="subsPerSec">0</span>/—Å–µ–∫ | –ö–ª–∏–∫: <span id="clickPower">1</span></small>
        </div>
        <div class="stat-card">
          <div class="stat-title">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä—ã</div>
          <div class="stat-value" id="viewsValue">0</div>
          <small>–í–∏—Ä—É—Å–Ω–æ—Å—Ç—å: <span id="viralChance">5</span>%</small>
        </div>
        <div class="stat-card">
          <div class="stat-title">üí∞ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è</div>
          <div class="stat-value" id="moneyValue">0‚ÇΩ</div>
          <small>–°–µ–∫—É–Ω–¥–∞: <span id="incomeValue">0</span>‚ÇΩ | –í–∏–¥–µ–æ: <span id="videoRevenue">0.5</span>‚ÇΩ/–ø—Ä–æ—Å–º–æ—Ç—Ä</small>
        </div>
        <div class="stat-card">
          <div class="stat-title">‚≠ê –ö–∞—á–µ—Å—Ç–≤–æ</div>
          <div class="stat-value" id="qualityValue">1.0</div>
          <small>–ú–Ω–æ–∂–∏—Ç–µ–ª—å: x<span id="qualityMult">1.0</span></small>
        </div>
        <div class="stat-card">
          <div class="stat-title">üéØ –ù–∏—à–∞</div>
          <div class="stat-value" id="nicheValue">–ì–µ–π–º–∏–Ω–≥</div>
          <small>–†–∏—Å–∫: <span id="riskValue">15</span>%</small>
        </div>
        <div class="stat-card">
          <div class="stat-title">üèÜ –†–µ–ø—É—Ç–∞—Ü–∏—è</div>
          <div class="stat-value" id="repValue">50</div>
          <small>–°–ø–æ–Ω—Å–æ—Ä—ã: <span id="sponsorCount">0</span>/5</small>
        </div>
      </div>

      <!-- –ü–†–û–ì–†–ï–°–° –°–™–ï–ú–ö–ò -->
      <div class="progress" style="margin: 30px 0;">
        <div class="progress-bar" id="recordProgressBar"></div>
      </div>
      <button class="btn" id="recordVideoBtn" onclick="recordVideo()" style="width: 100%; background: #FF0000; color: white; padding: 25px; font-size: 24px;">
        üé¨ –ù–ê–ß–ê–¢–¨ –°–™–ï–ú–ö–£ –í–ò–î–ï–û
      </button>

      <!-- –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 30px;">
        <button class="btn" onclick="rest()" style="background: #00FF00; color: #000;">üò¥ –û—Ç–¥–æ—Ö–Ω—É—Ç—å (+30 —ç–Ω–µ—Ä–≥–∏–∏)</button>
        <button class="btn" onclick="runAdCampaign()" style="background: #00FFFF; color: #000;">üì¢ –†–µ–∫–ª–∞–º–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è (5000‚ÇΩ)</button>
        <button class="btn" onclick="checkTrends()" style="background: #FFD700; color: #000;">üî• –°–ª–µ–¥–∏—Ç—å –∑–∞ —Ç—Ä–µ–Ω–¥–∞–º–∏</button>
        <button class="btn" onclick="collab()" style="background: #FF69B4; color: #000;">ü§ù –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—è</button>
        <button class="btn" onclick="merchSale()" style="background: #9370DB; color: #fff;">üëï –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–µ—Ä—á</button>
        <button class="btn" onclick="liveStream()" style="background: #FF6347; color: #fff;">üìπ –ü—Ä—è–º–æ–π —ç—Ñ–∏—Ä</button>
      </div>
    </div>

    <!-- –ê–ü–ì–†–ï–ô–î–´ -->
    <div id="upgradesTab" class="tab-content" style="display: none;">
      <h2 style="color: #FF0000; margin-bottom: 25px;">üõ†Ô∏è –û–ë–û–†–£–î–û–í–ê–ù–ò–ï –ò –°–¢–£–î–ò–Ø</h2>
      <div class="upgrades-grid" id="upgradesGrid"></div>
      
      <h2 style="color: #00FF00; margin: 35px 0 25px;">üíé –£–õ–£–ß–®–ï–ù–ò–Ø –ö–ê–ù–ê–õ–ê</h2>
      <div class="upgrades-grid" id="channelUpgradesGrid"></div>
    </div>

    <!-- –ö–û–ú–ê–ù–î–ê -->
    <div id="staffTab" class="tab-content" style="display: none;">
      <h2 style="color: #00FFFF; margin-bottom: 25px;">üë• –ù–ê–ù–ò–ú–ê–ô –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–û–í</h2>
      <div class="staff-grid" id="staffGrid"></div>
    </div>

    <!-- –ê–ù–ê–õ–ò–¢–ò–ö–ê -->
    <div id="analyticsTab" class="tab-content" style="display: none;">
      <h2 style="color: #FFD700; margin-bottom: 25px;">üìà –ü–û–î–†–û–ë–ù–ê–Ø –ê–ù–ê–õ–ò–¢–ò–ö–ê</h2>
      <canvas id="analyticsChart"></canvas>
      <div class="stats-grid" style="margin-top: 25px;">
        <div class="stat-card"><div class="stat-title">CTR (–ö–ª–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å)</div><div class="stat-value" id="ctrValue">10%</div></div>
        <div class="stat-card"><div class="stat-title">Watch Time</div><div class="stat-value" id="watchTimeValue">0—á</div></div>
        <div class="stat-card"><div class="stat-title">–õ–∞–π–∫–∏</div><div class="stat-value" id="likesValue">0</div></div>
        <div class="stat-card"><div class="stat-title">–î–∏–∑–ª–∞–π–∫–∏</div><div class="stat-value" id="dislikesValue">0</div></div>
        <div class="stat-card"><div class="stat-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</div><div class="stat-value" id="commentsValue">0</div></div>
        <div class="stat-card"><div class="stat-title">–†–µ–ø–æ—Å—Ç—ã</div><div class="stat-value" id="sharesValue">0</div></div>
      </div>
    </div>

    <!-- –ú–ò–°–°–ò–ò -->
    <div id="missionsTab" class="tab-content" style="display: none;">
      <h2 style="color: #00FF00; margin-bottom: 25px;">üéØ –ú–ò–°–°–ò–ò –ò –ù–ê–ì–†–ê–î–´</h2>
      <div class="missions-grid" id="missionsGrid"></div>
    </div>

    <!-- –°–ü–û–ù–°–û–†–´ -->
    <div id="sponsorsTab" class="tab-content" style="display: none;">
      <h2 style="color: #FFD700; margin-bottom: 25px;">üí∞ –°–ü–û–ù–°–û–†–°–ö–ò–ï –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø</h2>
      <div id="sponsorsList"></div>
    </div>

    <!-- –ü–†–ï–°–¢–ò–ñ -->
    <div id="prestigeTab" class="tab-content" style="display: none;">
      <h2 style="color: #FFD700; margin-bottom: 25px;">‚ú® –°–ò–°–¢–ï–ú–ê –ü–†–ï–°–¢–ò–ñ–ê</h2>
      <div class="stat-card">
        <p>–ö–æ–≥–¥–∞ –≤—ã –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç–µ <strong>1 –ú–ò–õ–õ–ò–û–ù–ê</strong> –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤, –≤—ã —Å–º–æ–∂–µ—Ç–µ:</p>
        <ul style="margin: 20px 0; line-height: 2;">
          <li>üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å</li>
          <li>üíé –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ—Å—Ç–∏–∂–Ω—ã–µ –æ—á–∫–∏</li>
          <li>‚ö° –í–µ—á–Ω—ã–µ –±–æ–Ω—É—Å—ã –∫ –¥–æ—Ö–æ–¥—É –∏ –∫–∞—á–µ—Å—Ç–≤—É</li>
          <li>üèÜ –û—Ç–∫—Ä—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞–ø–≥—Ä–µ–π–¥—ã</li>
        </ul>
        <button class="btn" onclick="prestigeConfirm()" style="background: #FFD700; color: #000; font-size: 20px; margin-top: 20px;" id="prestigeBtn" disabled>
          ‚ú® –ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –ü–†–ï–°–¢–ò–ñ (–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ)
        </button>
      </div>
    </div>

    <!-- –õ–û–ì –°–û–ë–´–¢–ò–ô -->
    <div class="event-log" id="eventLog">
      <div style="color: #666; text-align: center; padding: 20px;">üìù –ñ—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å...</div>
    </div>
  </div>

</div>

<script>
// ==================== –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï ====================
const STATE = {
  // –ë–∞–∑–∞
  name: '', niche: 'gaming', day: 1, money: 0, subscribers: 0, views: 0,
  
  // –†–µ—Å—É—Ä—Å—ã
  energy: 100, vibe: 100, motivation: 100,
  
  // –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
  income: 0, quality: 1, videos: 0, totalVideos: 0, isRecording: false, recordProgress: 0,
  
  // –°–∏—Å—Ç–µ–º—ã
  upgrades: {}, staff: {}, reputation: 50, burnOut: 0, currentTrend: null,
  
  // –ò—Å—Ç–æ—Ä–∏—è
  history: { subs: [], views: [], money: [], energy: [] }, oldVideos: [],
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  activeTab: 'dashboard',
  
  // –°–ø–æ–Ω—Å–æ—Ä—ã –∏ –º–∏—Å—Å–∏–∏
  sponsors: [], missions: [],
  
  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  stats: { ctr: 10, watchTime: 0, comments: 0, likes: 0, dislikes: 0, shares: 0 },
  
  // –ê—á–∏–≤–∫–∏
  awards: { silver: false, gold: false, diamond: false, ruby: false },
  
  // –ü—Ä–µ—Å—Ç–∏–∂
  prestigePoints: 0, permanentBonuses: { income: 0, quality: 0 },
  
  // –ö–ª–∏–∫
  clickPower: 1,
  
  // –†–µ–∫–ª–∞–º–∞
  adCampaign: null,
  
  // –°–æ–±—ã—Ç–∏—è
  lastEvent: null
  
};

// ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò–ì–†–´ ====================
const CONFIG = {
  niches: {
    gaming: { name: '–ì–µ–π–º–∏–Ω–≥', mult: { viral: 2.0, risk: 0.15, quality: 0.8, income: 1.2 }, color: '#FF0000' },
    beauty: { name: '–ë—å—é—Ç–∏', mult: { viral: 1.2, risk: 0.05, quality: 1.2, income: 1.5 }, color: '#FF69B4' },
    tech: { name: '–¢–µ—Ö–Ω–æ', mult: { viral: 1.0, risk: 0.02, quality: 1.5, income: 1.0 }, color: '#00CED1' },
    vlog: { name: '–í–ª–æ–≥', mult: { viral: 1.3, risk: 0.08, quality: 1.0, income: 0.9 }, color: '#FFD700' },
    music: { name: '–ú—É–∑—ã–∫–∞', mult: { viral: 1.8, risk: 0.20, quality: 1.0, income: 0.7 }, color: '#9370DB' },
    food: { name: '–ï–¥–∞', mult: { viral: 1.1, risk: 0.03, quality: 1.1, income: 1.3 }, color: '#FF8C00' }
  },
  
  upgrades: {
    mic: { name: 'üéôÔ∏è –ú–∏–∫—Ä–æ—Ñ–æ–Ω', cost: 100, income: 5, quality: 0.2, maxLevel: 10 },
    camera: { name: 'üì∑ –ö–∞–º–µ—Ä–∞', cost: 500, income: 20, quality: 0.5, maxLevel: 10 },
    light: { name: 'üí° –°–≤–µ—Ç', cost: 1500, income: 50, quality: 1, maxLevel: 10 },
    pc: { name: 'üíª –ö–æ–º–ø—å—é—Ç–µ—Ä', cost: 5000, income: 200, quality: 2, maxLevel: 10 },
    software: { name: 'üé¨ –ü–û', cost: 15000, income: 500, quality: 5, maxLevel: 10 },
    drone: { name: 'üöÅ –î—Ä–æ–Ω', cost: 30000, income: 1000, quality: 10, maxLevel: 5 },
    
    design: { name: 'üé® –î–∏–∑–∞–π–Ω', cost: 1000, income: 0, quality: 1, maxLevel: 5 },
    seo: { name: 'üîç SEO', cost: 2000, income: 0, quality: 0, ctr: 5, maxLevel: 5 },
    merch: { name: 'üëï –ú–µ—Ä—á', cost: 5000, income: 100, quality: 0, maxLevel: 5 },
    studio: { name: 'üè¢ –°—Ç—É–¥–∏—è', cost: 10000, income: 500, quality: 3, maxLevel: 5 },
    brand: { name: '¬©Ô∏è –ë—Ä–µ–Ω–¥–∏–Ω–≥', cost: 20000, income: 0, quality: 5, reputation: 10, maxLevel: 5 }
  },
  
  staff: {
    editor: { name: '‚úÇÔ∏è –ú–æ–Ω—Ç–∞–∂–µ—Ä', cost: 5000, salary: 50, income: 100, fatigue: 0, maxLevel: 5 },
    writer: { name: '‚úçÔ∏è –°—Ü–µ–Ω–∞—Ä–∏—Å—Ç', cost: 8000, salary: 80, quality: 0.5, fatigue: 0, maxLevel: 5 },
    designer: { name: 'üé® –î–∏–∑–∞–π–Ω–µ—Ä', cost: 10000, salary: 100, ctr: 2, fatigue: 0, maxLevel: 5 },
    manager: { name: 'üíº –ú–µ–Ω–µ–¥–∂–µ—Ä', cost: 15000, salary: 150, income: 200, reputation: 10, maxLevel: 5 },
    assistant: { name: 'ü§ñ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç', cost: 20000, salary: 200, energy: 10, fatigue: 0, maxLevel: 5 },
    lawyer: { name: '‚öñÔ∏è –Æ—Ä–∏—Å—Ç', cost: 30000, salary: 300, risk: -0.1, fatigue: 0, maxLevel: 3 }
  },
  
  missions: [
    { id: 1, name: '–ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ', desc: '–°–æ–∑–¥–∞–π—Ç–µ 1 –≤–∏–¥–µ–æ', target: 1, reward: 100, type: 'videos', icon: 'üé¨' },
    { id: 2, name: '–ù–æ–≤–∏—á–æ–∫', desc: '–ù–∞–±–µ—Ä–∏—Ç–µ 100 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 100, reward: 500, type: 'subs', icon: 'üë•' },
    { id: 3, name: '–ú–∏–Ω–∏-–±–ª–æ–≥–µ—Ä', desc: '–ù–∞–±–µ—Ä–∏—Ç–µ 1,000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 1000, reward: 5000, type: 'subs', icon: '‚≠ê' },
    { id: 4, name: '–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è', desc: '–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 10,000‚ÇΩ', target: 10000, reward: 1000, type: 'money', icon: 'üí∞' },
    { id: 5, name: '–ö–æ–Ω—Ç–µ–Ω—Ç-–º–µ–π–∫–µ—Ä', desc: '–°–æ–∑–¥–∞–π—Ç–µ 50 –≤–∏–¥–µ–æ', target: 50, reward: 10000, type: 'videos', icon: 'üìπ' },
    { id: 6, name: '–°–µ—Ä–µ–±—Ä–æ', desc: '100,000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 100000, reward: 50000, type: 'subs', award: 'silver', icon: 'ü•à' },
    { id: 7, name: '–ó–æ–ª–æ—Ç–æ', desc: '1,000,000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 1000000, reward: 500000, type: 'subs', award: 'gold', icon: 'ü•á' },
    { id: 8, name: '–ê–ª–º–∞–∑', desc: '10,000,000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 10000000, reward: 5000000, type: 'subs', award: 'diamond', icon: 'üíé' },
    { id: 9, name: '–†—É–±–∏–Ω', desc: '100,000,000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', target: 100000000, reward: 50000000, type: 'subs', award: 'ruby', icon: 'üíé' }
  ],
  
  trends: [
    { name: '–ß–µ–ª–ª–µ–Ω–¥–∂', bonus: 3, duration: 30000, icon: 'üèÉ' },
    { name: '–í–∞–π–Ω', bonus: 2.5, duration: 25000, icon: 'üé≠' },
    { name: '–†–µ–∞–∫—Ü–∏—è', bonus: 2, duration: 20000, icon: 'üò±' },
    { name: '–ú—É–∫–±–∞–Ω–≥', bonus: 1.8, duration: 20000, icon: 'üçî' },
    { name: '–ê–°–ú–†', bonus: 1.5, duration: 15000, icon: 'üîä' },
    { name: '–ü—Ä–∞–Ω–∫', bonus: 4, duration: 40000, icon: 'üé™' },
    { name: '–û–±–∑–æ—Ä', bonus: 1.3, duration: 18000, icon: 'üìã' },
    { name: '–¢—É—Ç–æ—Ä–∏–∞–ª', bonus: 1.2, duration: 16000, icon: 'üìö' }
  ],
  
  sponsors: [
    { id: 1, name: 'Raid Shadow Legends', reward: 5000, requirement: 1000, type: 'money', icon: 'üéÆ' },
    { id: 2, name: 'NordVPN', reward: 10000, requirement: 5000, type: 'money', icon: 'üîí' },
    { id: 3, name: 'Skillshare', reward: 15000, requirement: 10000, type: 'money', icon: 'üìö' },
    { id: 4, name: 'Squarespace', reward: 20000, requirement: 20000, type: 'money', icon: 'üåê' },
    { id: 5, name: 'GFuel', reward: 30000, requirement: 50000, type: 'money', icon: '‚ö°' }
  ]
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================

function init() {
  // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ state
  const loaded = loadGame();
  if (!loaded) {
    // –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É upgrades
    Object.keys(CONFIG.upgrades).forEach(key => {
      STATE.upgrades[key] = { ...CONFIG.upgrades[key], level: 0 };
    });
    // –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É staff
    Object.keys(CONFIG.staff).forEach(key => {
      STATE.staff[key] = { ...CONFIG.staff[key], hired: false, level: 0, fatigue: 0 };
    });
    // –°–æ–∑–¥–∞—Ç—å –º–∏—Å—Å–∏–∏
    STATE.missions = CONFIG.missions.map(m => ({ ...m, progress: 0, completed: false }));
    // –°–æ–∑–¥–∞—Ç—å —Å–ø–æ–Ω—Å–æ—Ä–æ–≤
    STATE.sponsors = CONFIG.sponsors.map(s => ({ ...s, offered: false, accepted: false }));
    // –ò—Å—Ç–æ—Ä–∏—è
    STATE.history = { subs: Array(60).fill(0), views: Array(60).fill(0), money: Array(60).fill(0) };
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å UI
  initNicheSelector();
  updateAllUI();
  initGameLoop();
  initStaffLoop();
  initTrendLoop();
  initAutoSave();
  initEventLoop();
  
  // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –Ω–∞—á–∞—Ç–∞
  if (STATE.name) {
    showScreen('gameScreen');
    STATE.activeTab = 'dashboard';
    updateDashboard();
    initCharts();
  }
}

// ==================== –°–¢–ê–†–¢ ==========
window.addEventListener('DOMContentLoaded', init);

// =============== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===============

function init() {
  // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ state
  const loaded = loadGame();
  if (!loaded) {
    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É upgrades
    Object.keys(CONFIG.upgrades).forEach(key => {
      GAME.upgrades[key] = { ...CONFIG.upgrades[key], level: 0 };
    });
    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É staff
    Object.keys(CONFIG.staff).forEach(key => {
      GAME.staff[key] = { ...CONFIG.staff[key], hired: false, level: 0, fatigue: 0 };
    });
    // –°–æ–∑–¥–∞–µ–º –º–∏—Å—Å–∏–∏
    GAME.missions = CONFIG.missions.map(m => ({ ...m, progress: 0, completed: false }));
    // –°–æ–∑–¥–∞–µ–º —Å–ø–æ–Ω—Å–æ—Ä–æ–≤
    GAME.sponsors = CONFIG.sponsors.map(s => ({ ...s, offered: false, accepted: false }));
    // –ò—Å—Ç–æ—Ä–∏—è
    GAME.history = { subs: Array(60).fill(0), views: Array(60).fill(0), money: Array(60).fill(0) };
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º UI
  updateAllUI();
  initGameLoop();
  initStaffLoop();
  initTrendLoop();
  initAutoSave();
  initEventLoop();
  
  // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –Ω–∞—á–∞—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω
  if (GAME.name) {
    showScreen('gameScreen');
    startGameLoop();
  }
}

// =============== –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ –ò–ì–†–´ ===============

function startGameLoop() {
  if (window.gameLoopInitialized) return;
  window.gameLoopInitialized = true;
  
  let lastTime = performance.now();
  
  setInterval(() => {
    const now = performance.now();
    const delta = (now - lastTime) / 1000;
    lastTime = now;
    
    if (!GAME.name) return;
    
    // –ü–ê–°–°–ò–í–ù–´–ô –î–û–•–û–î
    GAME.money += GAME.income * delta;
    
    // –°–û–¢–†–£–î–ù–ò–ö–ò
    Object.entries(GAME.staff).forEach(([key, staff]) => {
      if (!staff.hired || staff.fatigue >= 100) return;
      GAME.money += (staff.income * (staff.level + 1)) * delta * 0.1;
      staff.fatigue = Math.min(100, staff.fatigue + delta * 2);
    });
    
    // –°–¢–ê–†–´–ï –í–ò–î–ï–û
    GAME.oldVideos = GAME.oldVideos.filter(video => {
      video.age += delta * 10;
      if (video.age > 10) {
        const passive = Math.floor(video.views * 0.01 * (1 + GAME.quality / 10) / (1 + video.age / 100));
        GAME.views += passive;
      }
      return video.age < 100;
    });
    
    // –£–°–¢–ê–õ–û–°–¢–¨
    if (GAME.energy < 100) GAME.energy = Math.min(100, GAME.energy + delta * 5);
    if (GAME.vibe < 100) GAME.vibe = Math.min(100, GAME.vibe + delta * 2);
    
    // BURNOUT
    if (GAME.burnOut > 0) GAME.burnOut = Math.max(0, GAME.burnOut - delta);
    
    // –û–ë–ù–û–í–õ–Ø–ï–ú UI
    updateDashboard();
    
  }, 1000 / 60); // 60 FPS
}

// =============== –°–™–ï–ú–ö–ê –í–ò–î–ï–û ===============

function recordVideo() {
  if (GAME.isRecording || GAME.energy < 10) {
    if (GAME.energy < 10) addEvent('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏! –û—Ç–¥–æ—Ö–Ω–∏—Ç–µ!', 'fail');
    return;
  }
  
  GAME.isRecording = true;
  GAME.energy -= 10;
  GAME.recordProgress = 0;
  
  addEvent('üé¨ –ù–∞—á–∞–ª–∞—Å—å —Å—ä–µ–º–∫–∞ –≤–∏–¥–µ–æ...', 'neutral');
  
  const interval = setInterval(() => {
    GAME.recordProgress += 5;
    document.getElementById('recordProgressBar').style.width = GAME.recordProgress + '%';
    
    if (GAME.recordProgress >= 100) {
      clearInterval(interval);
      finishVideo();
    }
  }, 100);
}

function finishVideo() {
  GAME.isRecording = false;
  GAME.videos++;
  GAME.totalVideos++;
  
  const niche = CONFIG.niches[GAME.niche];
  const baseViews = Math.floor(Math.random() * 200) + 50;
  const subBonus = Math.floor(GAME.subscribers * 0.15);
  const trendBonus = GAME.currentTrend ? GAME.currentTrend.bonus : 1;
  const qualityBonus = 1 + (GAME.quality * 0.5);
  const totalViews = Math.floor((baseViews + subBonus) * trendBonus * qualityBonus * niche.mult.viral);
  
  // –í–∏—Ä—É—Å–Ω–æ—Å—Ç—å
  const viralRoll = Math.random();
  let finalViews = totalViews;
  let message = `üìπ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ! +${totalViews} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤`;
  let type = 'success';
  
  if (viralRoll < 0.05) {
    finalViews *= 20;
    message = `üî•üî•üî• –ú–ï–ì–ê –í–ò–†–ê–õ! +${finalViews} –ü–†–û–°–ú–û–¢–†–û–í!!!`;
    type = 'viral';
    GAME.reputation += 5;
  } else if (viralRoll < 0.15) {
    finalViews *= 5;
    message = `üî• –í–ò–†–ê–õ! +${finalViews} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤!`;
    type = 'viral';
  } else if (viralRoll < 0.3) {
    message = `üëç –•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! +${finalViews} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤`;
  } else if (viralRoll < 0.4) {
    finalViews = Math.floor(finalViews * 0.3);
    message = `üòï –ü—Ä–æ–≤–∞–ª... +${finalViews} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤`;
    type = 'fail';
    
    // –ü–æ—Ç–µ—Ä—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
    if (Math.random() < 0.3) {
      const lost = Math.floor(GAME.subscribers * 0.02);
      GAME.subscribers -= lost;
      message += `, -${lost} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤`;
    }
  }
  
  // –ü—Ä–∏–º–µ–Ω—è–µ–º
  GAME.views += finalViews;
  const newSubs = Math.floor(finalViews * (0.08 + GAME.quality / 100));
  if (type !== 'fail') GAME.subscribers += newSubs;
  
  const revenue = Math.floor(finalViews * 0.5 * (1 + GAME.quality / 10));
  GAME.money += revenue;
  
  addEvent(message, type);
  if (type !== 'fail') addEvent(`üí∞ +${revenue}‚ÇΩ, +${newSubs} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤`, 'money');
  
  // –°—Ç–∞—Ä—ã–µ –≤–∏–¥–µ–æ
  GAME.oldVideos.push({ views: finalViews, age: 0 });
  
  // –ú–∏—Å—Å–∏–∏
  updateMissions('videos', 1);
  updateMissions('views', finalViews);
  
  // –û–ø—ã—Ç
  GAME.vibe = Math.min(100, GAME.vibe + 5);
  GAME.motivation = Math.min(100, GAME.motivation + 2);
  
  // –ì—Ä–∞—Ñ–∏–∫–∏
  updateHistory();
  
  // –ê—á–∏–≤–∫–∏
  checkAwards();
  
  // –°–±—Ä–æ—Å
  GAME.recordProgress = 0;
  document.getElementById('recordProgressBar').style.width = '0%';
  
  updateDashboard();
  updateCharts();
  saveGame();
}

// =============== –£–õ–£–ß–®–ï–ù–ò–Ø ===============

function initUpgrades() {
  const grid = document.getElementById('upgradesGrid');
  const channelGrid = document.getElementById('channelUpgradesGrid');
  
  grid.innerHTML = '';
  channelGrid.innerHTML = '';
  
  // –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
  Object.entries(CONFIG.upgrades).forEach(([key, up]) => {
    const level = STATE.upgrades[key]?.level || 0;
    const cost = Math.floor(up.cost * Math.pow(1.5, level));
    
    const card = document.createElement('div');
    card.className = 'upgrade-card';
    card.innerHTML = `
      <div class="upgrade-name">${up.name} [–£—Ä. ${level}/${up.maxLevel}]</div>
      <div class="upgrade-desc">${up.desc || `–î–æ—Ö–æ–¥: +${up.income}‚ÇΩ/—Å–µ–∫, –ö–∞—á–µ—Å—Ç–≤–æ: +${up.quality}‚≠ê`}</div>
      <div class="upgrade-stats">
        –î–æ—Ö–æ–¥: +${up.income * (level + 1)}‚ÇΩ/—Å–µ–∫<br>
        –ö–∞—á–µ—Å—Ç–≤–æ: +${(up.quality || 0) * (level + 1)}‚≠ê
      </div>
      <button class="upgrade-btn" onclick="buyUpgrade('${key}')" ${level >= up.maxLevel ? 'disabled' : ''}>
        ${level >= up.maxLevel ? '–ú–ê–ö–°' : `${format(cost)}‚ÇΩ`}
      </button>
    `;
    grid.appendChild(card);
  });
}

function buyUpgrade(key) {
  const up = CONFIG.upgrades[key];
  const level = STATE.upgrades[key].level;
  const cost = Math.floor(up.cost * Math.pow(1.5, level));
  
  if (STATE.money < cost) {
    addEvent('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'fail');
    return;
  }
  
  if (level >= up.maxLevel) return;
  
  STATE.money -= cost;
  STATE.upgrades[key].level++;
  STATE.income += up.income;
  STATE.quality += up.quality || 0;
  
  if (up.ctr) STATE.stats.ctr += up.ctr;
  if (up.reputation) STATE.reputation += up.reputation;
  
  addEvent(`‚úÖ ${up.name} —É–ª—É—á—à–µ–Ω!`, 'success');
  initUpgrades();
  updateDashboard();
  saveGame();
}

// =============== –°–û–¢–†–£–î–ù–ò–ö–ò ===============

function initStaff() {
  const grid = document.getElementById('staffGrid');
  grid.innerHTML = '';
  
  Object.entries(CONFIG.staff).forEach(([key, staff]) => {
    const hired = STATE.staff[key]?.hired;
    const level = STATE.staff[key]?.level || 0;
    const cost = Math.floor(staff.cost * Math.pow(1.8, level));
    
    const card = document.createElement('div');
    card.className = 'staff-card';
    card.innerHTML = `
      <div class="upgrade-name">${staff.name} ${hired ? `[–£—Ä. ${level}]` : '[–ù–µ –Ω–∞–Ω—è—Ç]'}</div>
      <div class="upgrade-desc">
        ${hired ? `–ó–∞—Ä–ø–ª–∞—Ç–∞: ${staff.salary * (level + 1)}‚ÇΩ/–¥–µ–Ω—å<br>–î–æ—Ö–æ–¥: +${staff.income * (level + 1)}‚ÇΩ/—Å–µ–∫` : `–°—Ç–æ–∏–º–æ—Å—Ç—å: ${format(cost)}‚ÇΩ`}
      </div>
      ${hired ? `
        <div class="staff-fatigue" style="background: #222; height: 10px; border-radius: 5px; margin: 10px 0;">
          <div class="staff-fatigue-fill" style="width: ${100 - (STATE.staff[key].fatigue || 0)}%"></div>
        </div>
        <button class="upgrade-btn" onclick="levelUpStaff('${key}')">–ü–û–í–´–°–ò–¢–¨ ${format(Math.floor(cost * 0.5))}‚ÇΩ</button>
        <button class="upgrade-btn" onclick="fireStaff('${key}')" style="background: #800;">–£–í–û–õ–ò–¢–¨</button>
      ` : `
        <button class="upgrade-btn" onclick="hireStaff('${key}')">–ù–ê–ù–Ø–¢–¨ ${format(cost)}‚ÇΩ</button>
      `}
    `;
    grid.appendChild(card);
  });
}

function hireStaff(key) {
  const staff = CONFIG.staff[key];
  const cost = staff.cost;
  
  if (STATE.money < cost) {
    addEvent('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'fail');
    return;
  }
  
  STATE.money -= cost;
  STATE.staff[key] = { ...staff, hired: true, level: 0, fatigue: 0 };
  
  addEvent(`üë• –ù–∞–Ω—è—Ç ${staff.name}!`, 'success');
  initStaff();
  updateDashboard();
  saveGame();
}

function levelUpStaff(key) {
  const staff = STATE.staff[key];
  const base = CONFIG.staff[key];
  const cost = Math.floor(base.cost * Math.pow(1.8, staff.level) * 0.5);
  
  if (STATE.money < cost) {
    addEvent('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'fail');
    return;
  }
  
  STATE.money -= cost;
  staff.level++;
  staff.income = base.income * (staff.level + 1);
  staff.salary = base.salary * (staff.level + 1);
  
  addEvent(`üë• ${staff.name} –ø–æ–≤—ã—à–µ–Ω –¥–æ ${staff.level + 1} —É—Ä–æ–≤–Ω—è!`, 'success');
  initStaff();
  updateDashboard();
  saveGame();
}

function fireStaff(key) {
  if (!confirm(`–£–≤–æ–ª–∏—Ç—å ${STATE.staff[key].name}?`)) return;
  
  delete STATE.staff[key];
  addEvent(`üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫ —É–≤–æ–ª–µ–Ω`, 'warning');
  initStaff();
  updateDashboard();
  saveGame();
}

// =============== –¶–ò–ö–õ –°–û–¢–†–£–î–ù–ò–ö–û–í ===============

function initStaffLoop() {
  setInterval(() => {
    Object.entries(STATE.staff).forEach(([key, staff]) => {
      if (!staff.hired) return;
      
      staff.fatigue += 5;
      if (staff.fatigue > 100) staff.fatigue = 100;
      
      // –ê–≤—Ç–æ-—Ä–∞–±–æ—Ç–∞
      if (staff.fatigue < 80 && staff.level > 0) {
        STATE.money += (staff.income * (staff.level + 1)) * 0.1;
      }
    });
  }, 10000);
}

// =============== –¢–†–ï–ù–î–´ ===============

function initTrendLoop() {
  setInterval(() => {
    if (STATE.currentTrend && STATE.currentTrend.endTime < Date.now()) {
      STATE.currentTrend = null;
      addEvent('üìâ –¢—Ä–µ–Ω–¥ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è', 'neutral');
    }
    
    if (!STATE.currentTrend && Math.random() < 0.5) {
      const trend = CONFIG.trends[Math.floor(Math.random() * CONFIG.trends.length)];
      STATE.currentTrend = {
        ...trend,
        endTime: Date.now() + trend.duration
      };
      addEvent(`${trend.icon} –ù–û–í–´–ô –¢–†–ï–ù–î: ${trend.name}! –ë–æ–Ω—É—Å x${trend.bonus}`, 'success');
    }
  }, 30000);
}

// =============== –ì–†–ê–§–ò–ö–ò ===============

function initCharts() {
  // Chart.js —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω
  const ctx = document.getElementById('analyticsChart');
  if (!ctx) return;
  
  if (window.myChart) window.myChart.destroy();
  
  window.myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: Array(60).fill('').map((_, i) => i + 1),
      datasets: [{
        label: '–ü–æ–¥–ø–∏—Å—á–∏–∫–∏',
        data: GAME.history.subs,
        borderColor: '#FF0000',
        backgroundColor: 'rgba(255,0,0,0.1)',
        tension: 0.4,
        fill: true
      }, {
        label: '–ü—Ä–æ—Å–º–æ—Ç—Ä—ã',
        data: GAME.history.views,
        borderColor: '#00FF00',
        backgroundColor: 'rgba(0,255,0,0.1)',
        tension: 0.4,
        fill: true
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { 
        legend: { labels: { color: '#fff' } },
        title: { display: true, text: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–∞', color: '#fff' }
      },
      scales: {
        x: { ticks: { color: '#aaa' } },
        y: { ticks: { color: '#aaa' } }
      }
    }
  });
}

function updateCharts() {
  if (!window.myChart) return;
  
  window.myChart.data.datasets[0].data = GAME.history.subs;
  window.myChart.data.datasets[1].data = GAME.history.views;
  window.myChart.update('none');
}

// =============== –ú–ò–°–°–ò–ò ===============

function updateMissions(type, amount) {
  GAME.missions.forEach(mission => {
    if (mission.completed) return;
    if (mission.type === type) {
      mission.progress += amount;
      if (mission.progress >= mission.target) {
        mission.completed = true;
        GAME.money += mission.reward;
        addEvent(`${mission.icon} –ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: ${mission.name}! +${mission.reward}‚ÇΩ`, 'success');
        if (mission.award) {
          GAME.awards[mission.award] = true;
          addEvent(`üèÜ –ü–æ–ª—É—á–µ–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞: ${mission.award}!`, 'viral');
        }
      }
    }
  });
  initMissions();
}

function initMissions() {
  const grid = document.getElementById('missionsGrid');
  if (!grid) return;
  
  grid.innerHTML = '';
  
  GAME.missions.filter(m => !m.completed).forEach(mission => {
    const progress = Math.min(mission.progress, mission.target);
    const percent = (progress / mission.target * 100).toFixed(1);
    
    const card = document.createElement('div');
    card.className = 'mission-card';
    card.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <strong>${mission.icon} ${mission.name}</strong><br>
          <small>${mission.desc}</small>
        </div>
        <div style="text-align: right;">
          <strong style="color: #FFD700;">${format(mission.reward)}‚ÇΩ</strong><br>
          <small>${format(progress)} / ${format(mission.target)}</small>
        </div>
      </div>
      <div class="mission-progress">
        <div class="mission-progress-fill" style="width: ${percent}%"></div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// =============== –°–ü–û–ù–°–û–†–´ ===============

function initSponsors() {
  const list = document.getElementById('sponsorsList');
  if (!list) return;
  
  list.innerHTML = '';
  
  // –ù–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
  GAME.sponsors.filter(s => !s.offered && GAME.subscribers >= s.requirement).forEach(sponsor => {
    const card = document.createElement('div');
    card.className = 'sponsor-card';
    card.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <strong>${sponsor.icon} ${sponsor.name}</strong><br>
          <small>–¢—Ä–µ–±—É–µ—Ç—Å—è: ${format(sponsor.requirement)} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</small>
        </div>
        <div>
          <strong style="color: #FFD700;">${format(sponsor.reward)}‚ÇΩ</strong><br>
          <button class="upgrade-btn" onclick="acceptSponsor(${sponsor.id})">–ü—Ä–∏–Ω—è—Ç—å</button>
        </div>
      </div>
    `;
    list.appendChild(card);
  });
  
  // –ê–∫—Ç–∏–≤–Ω—ã–µ
  GAME.sponsors.filter(s => s.accepted).forEach(sponsor => {
    const card = document.createElement('div');
    card.className = 'sponsor-card';
    card.style.opacity = '0.6';
    card.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <div style="opacity: 0.6;">
          <strong>${sponsor.icon} ${sponsor.name}</strong><br>
          <small>–ö–æ–Ω—Ç—Ä–∞–∫—Ç –∞–∫—Ç–∏–≤–µ–Ω</small>
        </div>
        <div style="opacity: 0.6;">
          <strong>${format(sponsor.reward)}‚ÇΩ</strong>
        </div>
      </div>
    `;
    list.appendChild(card);
  });
}

function acceptSponsor(id) {
  const sponsor = GAME.sponsors.find(s => s.id === id);
  if (!sponsor || sponsor.accepted) return;
  
  sponsor.accepted = true;
  sponsor.offered = true;
  GAME.money += sponsor.reward;
  GAME.reputation += 10;
  
  addEvent(`üí∞ –ü–æ–¥–ø–∏—Å–∞–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å ${sponsor.name}! +${sponsor.reward}‚ÇΩ`, 'money');
  initSponsors();
  updateDashboard();
  saveGame();
}

// =============== –î–ï–ô–°–¢–í–ò–Ø ===============

function rest() {
  if (GAME.energy >= 70) {
    addEvent('‚ùå –í—ã –Ω–µ —É—Å—Ç–∞–ª–∏!', 'fail');
    return;
  }
  GAME.energy = Math.min(100, GAME.energy + 30);
  GAME.vibe = Math.min(100, GAME.vibe + 20);
  GAME.burnOut = Math.max(0, GAME.burnOut - 10);
  addEvent('üò¥ –í—ã –æ—Ç–¥–æ—Ö–Ω—É–ª–∏! +30 —ç–Ω–µ—Ä–≥–∏–∏, +20 –≤–∞–π–±–∞', 'success');
  updateDashboard();
}

function runAdCampaign() {
  const cost = 5000;
  if (GAME.money < cost) {
    addEvent('‚ùå –ù—É–∂–Ω–æ 5000‚ÇΩ!', 'fail');
    return;
  }
  
  GAME.money -= cost;
  const gain = Math.floor(GAME.subscribers * 0.1);
  GAME.subscribers += gain;
  GAME.reputation += 5;
  
  addEvent(`üì¢ –†–µ–∫–ª–∞–º–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è! +${gain} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤`, 'success');
  updateDashboard();
  saveGame();
}

function checkTrends() {
  if (!GAME.currentTrend) {
    addEvent('‚ùå –°–µ–π—á–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤', 'fail');
    return;
  }
  
  GAME.energy -= 5;
  const bonus = GAME.currentTrend.bonus;
  GAME.vibe = Math.min(100, GAME.vibe + 10);
  
  addEvent(`üî• –í—ã –≤ —Ç—Ä–µ–Ω–¥–µ! –ë–æ–Ω—É—Å x${bonus} –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–∏–¥–µ–æ!`, 'success');
  updateDashboard();
}

function collab() {
  if (GAME.subscribers < 1000) {
    addEvent('‚ùå –ù—É–∂–Ω–æ 1000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!', 'fail');
    return;
  }
  
  if (GAME.money < 2000) {
    addEvent('‚ùå –ù—É–∂–Ω–æ 2000‚ÇΩ!', 'fail');
    return;
  }
  
  GAME.money -= 2000;
  const partner = Math.floor(Math.random() * 10000) + 1000;
  const gain = Math.floor(partner * 0.1);
  GAME.subscribers += gain;
  GAME.reputation += 10;
  GAME.vibe += 15;
  
  addEvent(`ü§ù –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—è —Å –∫–∞–Ω–∞–ª–æ–º ${partner} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤! +${gain} –≤–∞–º!`, 'success');
  updateDashboard();
  saveGame();
}

function merchSale() {
  if (GAME.subscribers < 5000) {
    addEvent('‚ùå –ù—É–∂–Ω–æ 5000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!', 'fail');
    return;
  }
  
  const revenue = Math.floor(GAME.subscribers * 0.5 * (1 + GAME.quality / 10));
  GAME.money += revenue;
  GAME.reputation += 2;
  
  addEvent(`üëï –ü—Ä–æ–¥–∞–∂–∞ –º–µ—Ä—á–∞! +${revenue}‚ÇΩ`, 'money');
  updateDashboard();
  saveGame();
}

function liveStream() {
  if (GAME.energy < 20) {
    addEvent('‚ùå –ù—É–∂–Ω–æ 20 —ç–Ω–µ—Ä–≥–∏–∏!', 'fail');
    return;
  }
  
  GAME.energy -= 20;
  const viewers = Math.floor(GAME.subscribers * 0.3);
  const donations = Math.floor(Math.random() * 1000) + 100;
  
  GAME.money += donations;
  GAME.views += viewers;
  GAME.vibe += 25;
  
  addEvent(`üìπ –ü—Ä—è–º–æ–π —ç—Ñ–∏—Ä! ${viewers} –∑—Ä–∏—Ç–µ–ª–µ–π, +${donations}‚ÇΩ –¥–æ–Ω–∞—Ç–æ–≤`, 'success');
  updateDashboard();
  saveGame();
}

// =============== –¶–ò–ö–õ –°–û–ë–´–¢–ò–ô ===============

function initEventLoop() {
  setInterval(() => {
    if (!GAME.name) return;
    
    const rand = Math.random();
    const nicheRisk = CONFIG.niches[GAME.niche].mult.risk;
    
    // –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
    if (rand < nicheRisk) {
      const events = [
        { text: 'üò§ –°–∫–∞–Ω–¥–∞–ª –≤ —Ç–≤–∏—Ç—Ç–µ—Ä–µ! –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ –æ—Ç–ø–∏—Å—ã–≤–∞—é—Ç—Å—è', effect: () => GAME.subscribers -= Math.floor(GAME.subscribers * 0.03) },
        { text: 'üíª –ê–ª–≥–æ—Ä–∏—Ç–º YouTube —É–¥–∞—Ä–∏–ª –ø–æ –≤–∞—à–µ–º—É –∫–∞–Ω–∞–ª—É!', effect: () => GAME.income *= 0.9 },
        { text: 'üò¥ –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª –≤–∞—à–µ –≤–∏–¥–µ–æ!', effect: () => GAME.views *= 0.95 },
        { text: '‚öñÔ∏è –ê–≤—Ç–æ—Ä—Å–∫–∏–π –∏—Å–∫! –Æ—Ä–∏—Å—Ç –Ω—É–∂–µ–Ω', effect: () => GAME.money -= 5000 },
        { text: 'üî• –ù–µ–≥–∞—Ç–∏–≤ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö! –†–µ–ø—É—Ç–∞—Ü–∏—è –ø–∞–¥–∞–µ—Ç', effect: () => GAME.reputation -= 10 }
      ];
      
      const event = events[Math.floor(Math.random() * events.length)];
      event.effect();
      addEvent(event.text, 'fail');
    }
    
    // –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
    else if (rand < 0.3) {
      const events = [
        { text: 'üìà –í–∞—à–µ –≤–∏–¥–µ–æ –ø–æ–ø–∞–ª–æ –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏!', effect: () => GAME.subscribers += Math.floor(GAME.subscribers * 0.05) },
        { text: 'üí¨ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –≤ –°–ú–ò! –†–µ–ø—É—Ç–∞—Ü–∏—è —Ä–∞—Å—Ç–µ—Ç', effect: () => GAME.reputation += 5 },
        { text: 'üéÅ –ü–æ–¥–∞—Ä–æ–∫ –æ—Ç —Ñ–∞–Ω–∞—Ç–∞! +1000‚ÇΩ', effect: () => GAME.money += 1000 },
        { text: 'üì∫ –í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∏ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤—å—é! +100 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', effect: () => GAME.subscribers += 100 }
      ];
      
      const event = events[Math.floor(Math.random() * events.length)];
      event.effect();
      addEvent(event.text, 'success');
    }
    
    // –°–ø–∞–≤–Ω —Å–ø–æ–Ω—Å–æ—Ä–æ–≤
    GAME.sponsors.forEach(sponsor => {
      if (!sponsor.offered && GAME.subscribers >= sponsor.requirement) {
        sponsor.offered = true;
        addEvent(`üí∞ ${sponsor.name} —Ö–æ—á–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å!`, 'money');
      }
    });
    
    // –≠–Ω–µ—Ä–≥–∏—è
    if (GAME.energy < 100) GAME.energy = Math.min(100, GAME.energy + 2);
    
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∞–π–±–∞
    if (GAME.vibe < 100) GAME.vibe = Math.min(100, GAME.vibe + 1);
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ burnOut
    if (GAME.burnOut > 0) GAME.burnOut = Math.max(0, GAME.burnOut - 1);
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    updateDashboard();
    updateStaff();
    
  }, 15000); // –ö–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
}

// =============== –û–ë–ù–û–í–õ–ï–ù–ò–ï UI ===============

function updateDashboard() {
  // –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∞—Ç—ã
  document.getElementById('subsValue').textContent = format(GAME.subscribers);
  document.getElementById('viewsValue').textContent = format(GAME.views);
  document.getElementById('moneyValue').textContent = format(GAME.money) + '‚ÇΩ';
  document.getElementById('incomeValue').textContent = format(GAME.income);
  document.getElementById('qualityValue').textContent = GAME.quality.toFixed(1);
  document.getElementById('nicheValue').textContent = CONFIG.niches[GAME.niche].name;
  document.getElementById('repValue').textContent = GAME.reputation;
  
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
  document.getElementById('subsPerSec').textContent = format(GAME.income / 10);
  document.getElementById('viralChance').textContent = Math.floor(CONFIG.niches[GAME.niche].mult.viral * 5);
  document.getElementById('videoRevenue').textContent = (0.5 * (1 + GAME.quality / 10)).toFixed(2);
  document.getElementById('qualityMult').textContent = GAME.quality.toFixed(1);
  document.getElementById('riskValue').textContent = Math.floor(CONFIG.niches[GAME.niche].mult.risk * 100);
  document.getElementById('sponsorCount').textContent = GAME.sponsors.filter(s => s.accepted).length;
  
  // –≠–Ω–µ—Ä–≥–∏—è –∏ –≤–∞–π–±
  document.getElementById('energyDisplay').textContent = Math.floor(GAME.energy);
  document.getElementById('vibeDisplay').style.width = GAME.vibe + '%';
  document.getElementById('dayDisplay').textContent = GAME.day;
  
  // –ê—á–∏–≤–∫–∏
  document.getElementById('silverButton').style.opacity = GAME.awards.silver ? '1' : '0.2';
  document.getElementById('goldButton').style.opacity = GAME.awards.gold ? '1' : '0.2';
  
  // –¢—Ä–µ–Ω–¥
  const trendDisplay = document.getElementById('trendDisplay');
  if (trendDisplay) {
    trendDisplay.textContent = GAME.currentTrend ? `${GAME.currentTrend.icon} ${GAME.currentTrend.name}` : '–ù–µ—Ç';
  }
}

function updateAllUI() {
  updateDashboard();
  initNicheSelector();
  initUpgrades();
  initStaff();
  initMissions();
  initSponsors();
  renderEvents();
}

function renderEvents() {
  const log = document.getElementById('eventLog');
  log.innerHTML = '<div style="color: #666; text-align: center; padding: 20px;">üìù –ñ—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π...</div>';
  
  if (GAME.events) {
    GAME.events.forEach(event => {
      const div = document.createElement('div');
      div.className = `event ${event.type}`;
      div.textContent = `[${new Date(event.time).toLocaleTimeString()}] ${event.text}`;
      log.insertBefore(div, log.firstChild);
    });
  }
}

// =============== –ì–†–ê–§–ò–ö–ò ===============

function initCharts() {
  const ctx = document.getElementById('analyticsChart');
  if (!ctx) return;
  
  if (window.myChart) window.myChart.destroy();
  
  window.myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: Array(60).fill('').map((_, i) => i + 1),
      datasets: [{
        label: '–ü–æ–¥–ø–∏—Å—á–∏–∫–∏',
        data: GAME.history.subs,
        borderColor: '#FF0000',
        backgroundColor: 'rgba(255,0,0,0.1)',
        tension: 0.4,
        fill: true
      }, {
        label: '–ü—Ä–æ—Å–º–æ—Ç—Ä—ã',
        data: GAME.history.views,
        borderColor: '#00FF00',
        backgroundColor: 'rgba(0,255,0,0.1)',
        tension: 0.4,
        fill: true
      }, {
        label: '–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è',
        data: GAME.history.money,
        borderColor: '#FFD700',
        backgroundColor: 'rgba(255,215,0,0.1)',
        tension: 0.4,
        fill: true
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { 
        legend: { labels: { color: '#fff' } },
        title: { display: true, text: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 60 —Å–µ–∫)', color: '#fff' }
      },
      scales: {
        x: { ticks: { color: '#aaa' } },
        y: { ticks: { color: '#aaa' } }
      }
    }
  });
}

function updateCharts() {
  if (!window.myChart) return;
  
  window.myChart.data.datasets[0].data = GAME.history.subs;
  window.myChart.data.datasets[1].data = GAME.history.views;
  window.myChart.data.datasets[2].data = GAME.history.money;
  window.myChart.update('none');
}

function updateHistory() {
  GAME.history.subs.push(GAME.subscribers);
  GAME.history.views.push(GAME.views);
  GAME.history.money.push(GAME.money);
  
  if (GAME.history.subs.length > 60) {
    GAME.history.subs.shift();
    GAME.history.views.shift();
    GAME.history.money.shift();
  }
}

// =============== –ê–ß–ò–í–ö–ò ===============

function checkAwards() {
  if (GAME.subscribers >= 100000 && !GAME.awards.silver) {
    GAME.awards.silver = true;
    addEvent('üèÜ –°–µ—Ä–µ–±—Ä—è–Ω–∞—è –∫–Ω–æ–ø–∫–∞ YouTube –ø–æ–ª—É—á–µ–Ω–∞!', 'viral');
  }
  if (GAME.subscribers >= 1000000 && !GAME.awards.gold) {
    GAME.awards.gold = true;
    addEvent('üèÜ –ó–æ–ª–æ—Ç–∞—è –∫–Ω–æ–ø–∫–∞ YouTube –ø–æ–ª—É—á–µ–Ω–∞!', 'viral');
  }
  if (GAME.subscribers >= 10000000 && !GAME.awards.diamond) {
    GAME.awards.diamond = true;
    addEvent('üíé –ê–ª–º–∞–∑–Ω–∞—è –∫–Ω–æ–ø–∫–∞ YouTube –ø–æ–ª—É—á–µ–Ω–∞!', 'viral');
  }
  if (GAME.subscribers >= 100000000 && !GAME.awards.ruby) {
    GAME.awards.ruby = true;
    addEvent('üíé –†—É–±–∏–Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ YouTube –ø–æ–ª—É—á–µ–Ω–∞!', 'viral');
  }
}

// =============== –°–û–•–†–ê–ù–ï–ù–ò–ï ===============

function saveGame() {
  localStorage.setItem('ytTycoonUltimate', JSON.stringify(GAME));
}

function loadGame() {
  const raw = localStorage.getItem('ytTycoonUltimate');
  if (!raw) return false;
  
  const loaded = JSON.parse(raw);
  Object.assign(GAME, loaded);
  return true;
}

function saveManual() {
  saveGame();
  addEvent('üíæ –ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!', 'success');
}

function resetGame() {
  if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —ç—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞?')) return;
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –∏ –Ω–∏—à—É
  const name = GAME.name;
  const niche = GAME.niche;
  
  // –°–±—Ä–æ—Å
  Object.assign(GAME, {
    subscribers: 0,
    views: 0,
    money: 0,
    income: 0,
    quality: 1,
    videos: 0,
    totalVideos: 0,
    day: 1,
    energy: 100,
    vibe: 100,
    motivation: 100,
    reputation: 50,
    burnOut: 0,
    awards: { silver: false, gold: false, diamond: false, ruby: false },
    upgrades: {},
    staff: {},
    oldVideos: [],
    history: { subs: Array(60).fill(0), views: Array(60).fill(0), money: Array(60).fill(0) },
    missions: CONFIG.missions.map(m => ({ ...m, progress: 0, completed: false })),
    sponsors: CONFIG.sponsors.map(s => ({ ...s, offered: false, accepted: false }))
  });
  
  // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
  GAME.name = name;
  GAME.niche = niche;
  
  // –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  Object.keys(CONFIG.upgrades).forEach(key => {
    GAME.upgrades[key] = { ...CONFIG.upgrades[key], level: 0 };
  });
  Object.keys(CONFIG.staff).forEach(key => {
    GAME.staff[key] = { ...CONFIG.staff[key], hired: false, level: 0, fatigue: 0 };
  });
  
  addEvent('üîÑ –ö–∞–Ω–∞–ª —Å–±—Ä–æ—à–µ–Ω!', 'warning');
  updateAllUI();
  saveGame();
}

function resetAll() {
  if (!confirm('–£–î–ê–õ–ò–¢–¨ –í–°–ï –î–ê–ù–ù–´–ï –í–ö–õ–Æ–ß–ê–Ø –¢–û–ü –ò –ù–ê–°–¢–†–û–ô–ö–ò?')) return;
  localStorage.removeItem('ytTycoonUltimate');
  localStorage.removeItem('ytTycoonTop');
  location.reload();
}

// =============== –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï ===============

function initAutoSave() {
  setInterval(() => {
    if (GAME.settings.autoSave) {
      saveGame();
      updateLeaderboard();
    }
  }, 3000);
}

// =============== –ü–û–ú–û–©–ù–ò–ö–ò ===============

function format(num) {
  if (num >= 1e9) return (num / 1e9).toFixed(1) + 'G';
  if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
  if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
  return Math.floor(num);
}

function addEvent(text, type = 'neutral') {
  const event = {
    text,
    type,
    time: Date.now()
  };
  
  // –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π
  if (!GAME.events) GAME.events = [];
  GAME.events.unshift(event);
  if (GAME.events.length > 20) GAME.events.pop();
  
  // DOM
  const log = document.getElementById('eventLog');
  const colors = {
    success: '#00FF00',
    fail: '#FF0000',
    warning: '#FFD700',
    viral: '#FF00FF',
    neutral: '#aaa',
    money: '#FFD700'
  };
  
  const div = document.createElement('div');
  div.className = `event ${type}`;
  div.style.borderLeftColor = colors[type] || '#aaa';
  div.style.color = colors[type] || '#fff';
  div.textContent = `[${new Date().toLocaleTimeString()}] ${text}`;
  log.insertBefore(div, log.firstChild);
  
  // –õ–∏–º–∏—Ç
  while (log.children.length > 15) {
    log.removeChild(log.lastChild);
  }
}

function updateLeaderboard() {
  const top = JSON.parse(localStorage.getItem('ytTycoonTop') || '[]');
  const entry = { 
    name: GAME.name, 
    subscribers: GAME.subscribers, 
    views: GAME.views, 
    day: GAME.day, 
    date: Date.now() 
  };
  
  const index = top.findIndex(e => e.name === GAME.name);
  if (index >= 0) top[index] = entry;
  else top.push(entry);
  
  top.sort((a, b) => b.subscribers - a.subscribers);
  if (top.length > 100) top.length = 100;
  
  localStorage.setItem('ytTycoonTop', JSON.stringify(top));
}

function showTopChannels() {
  const top = JSON.parse(localStorage.getItem('ytTycoonTop') || '[]');
  const list = document.getElementById('globalTopList');
  
  list.innerHTML = top.slice(0, 20).map((channel, i) => `
    <div class="top-entry ${channel.name === GAME.name ? 'me' : ''}">
      <div>
        <strong>#${i + 1}</strong> ${channel.name}
        <br><small>–î–µ–Ω—å ${channel.day}</small>
      </div>
      <div style="text-align: right;">
        ${format(channel.subscribers)} üë•
        <br>${format(channel.views)} üëÅÔ∏è
      </div>
    </div>
  `).join('');
  
  showScreen('topScreen');
}

function createChannel() {
  const name = document.getElementById('channelInput').value.trim();
  const error = document.getElementById('nameError');
  
  if (!name) {
    error.textContent = '‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞!';
    error.style.display = 'block';
    return;
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ø–∞
  const top = JSON.parse(localStorage.getItem('ytTycoonTop') || '[]');
  if (top.some(c => c.name === name)) {
    error.textContent = '‚ùå –≠—Ç–æ –∏–º—è —É–∂–µ –∑–∞–Ω—è—Ç–æ –≤ —Ç–æ–ø–µ!';
    error.style.display = 'block';
    return;
  }
  
  error.style.display = 'none';
  GAME.name = name;
  GAME.niche = document.querySelector('.niche-card.selected').dataset.niche;
  
  showScreen('gameScreen');
  STATE.activeTab = 'dashboard';
  updateAllUI();
  initCharts();
  addEvent('üéâ –ö–∞–Ω–∞–ª —Å–æ–∑–¥–∞–Ω! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä YouTube!', 'success');
  saveGame();
}

// =============== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===============

// –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è onclick
window.createChannel = createChannel;
window.selectNiche = (niche) => { GAME.niche = niche; initNicheSelector(); };
window.recordVideo = recordVideo;
window.buyUpgrade = buyUpgrade;
window.hireStaff = hireStaff;
window.levelUpStaff = levelUpStaff;
window.fireStaff = fireStaff;
window.acceptSponsor = acceptSponsor;
window.switchTab = switchTab;
window.showTopChannels = showTopChannels;
window.showScreen = showScreen;
window.rest = rest;
window.runAdCampaign = runAdCampaign;
window.checkTrends = checkTrends;
window.collab = collab;
window.merchSale = merchSale;
window.liveStream = liveStream;
window.prestigeConfirm = prestigeConfirm;
window.saveManual = saveManual;
window.resetGame = resetGame;
window.resetAll = resetAll;

// =============== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ===============

window.addEventListener('DOMContentLoaded', () => {
  init();
  // –ï—Å–ª–∏ –≤ URL –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
  if (window.location.hash === '#game') {
    const saved = loadGame();
    if (saved && GAME.name) {
      showScreen('gameScreen');
      updateAllUI();
    }
  }
});
// =============== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –°–ò–°–¢–ï–ú–´ (–ü–†–û–î–û–õ–ñ–ï–ù–ò–ï) ===============

// ========== –ü–†–ï–°–¢–ò–ñ ==========
function prestigeConfirm() {
  if (GAME.subscribers < 1000000) {
    addEvent('‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è 1 000 000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!', 'fail');
    return;
  }
  
  if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ—Å—Ç–∏–∂–Ω—ã–µ –æ—á–∫–∏?')) return;
  
  // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–µ—Å—Ç–∏–∂-–æ—á–∫–∏
  const prestigePoints = Math.floor(GAME.subscribers / 1000000) * 10;
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ—Å—Ç–∏–∂
  const oldPoints = GAME.prestigePoints || 0;
  GAME.prestigePoints = oldPoints + prestigePoints;
  
  // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤–µ—á–Ω—ã–µ –±–æ–Ω—É—Å—ã
  GAME.permanentBonuses.income += 0.5;
  GAME.permanentBonuses.quality += 0.5;
  
  // –°–±—Ä–æ—Å –∫–∞–Ω–∞–ª–∞ (–Ω–æ –Ω–µ —Ç–æ–ø–∞ –∏ –ø—Ä–µ—Å—Ç–∏–∂–∞)
  resetGame();
  
  addEvent(`‚ú® –ü–†–ï–°–¢–ò–ñ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù! +${prestigePoints} –æ—á–∫–æ–≤`, 'viral');
  addEvent('üíé –û—Ç–∫—Ä—ã—Ç—ã –≤–µ—á–Ω—ã–µ –±–æ–Ω—É—Å—ã!', 'success');
}

// ========== –°–ò–°–¢–ï–ú–ê –ö–õ–ò–ö–û–í (–î–õ–Ø –ú–û–ë–ò–õ–¨–ù–´–•) ==========
let clickPower = 1;

function initClickSystem() {
  // –ö–Ω–æ–ø–∫–∞ "–ö–õ–ò–ö" –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
  const clickBtn = document.createElement('button');
  clickBtn.className = 'btn';
  clickBtn.id = 'clickBtn';
  clickBtn.innerHTML = 'üëÜ –ö–õ–ò–ö (+1 –ø–æ–¥–ø–∏—Å—á–∏–∫)';
  clickBtn.onclick = clickAction;
  clickBtn.style.cssText = `
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: linear-gradient(135deg, #FF0000, #FFD700);
    color: white;
    padding: 15px 25px;
    font-size: 18px;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(255,0,0,0.5);
    z-index: 9999;
    transition: all 0.2s;
  `;
  document.body.appendChild(clickBtn);
  
  // –£–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∏–∫–∞ —á–µ—Ä–µ–∑ –∞–ø–≥—Ä–µ–π–¥—ã
  const clickUpgrade = {
    name: 'üí™ –ö–ª–∏–∫ –ú–æ—â–Ω–æ—Å—Ç—å',
    cost: 100,
    level: 0,
    maxLevel: 50,
    effect: () => clickPower += 1
  };
  
  // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∞–ø–≥—Ä–µ–π–¥—ã
  if (!CONFIG.upgrades.click) {
    CONFIG.upgrades.click = clickUpgrade;
  }
}

function clickAction() {
  // –ë–∞–∑–æ–≤—ã–π –∫–ª–∏–∫
  STATE.subscribers += clickPower;
  
  // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫
  if (Math.random() < 0.01) {
    const crit = clickPower * 10;
    STATE.subscribers += crit;
    addEvent(`üí• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ö–õ–ò–ö! +${crit} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!`, 'viral');
  } else {
    addEvent(`üëÜ –ö–ª–∏–∫! +${clickPower} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤`, 'success');
  }
  
  // –≠—Ñ—Ñ–µ–∫—Ç —á–∞—Å—Ç–∏—Ü
  createClickParticles();
  
  updateDashboard();
  saveGame();
}

function createClickParticles() {
  const particles = 5;
  for (let i = 0; i < particles; i++) {
    const particle = document.createElement('div');
    particle.style.cssText = `
      position: fixed;
      width: 10px;
      height: 10px;
      background: #FFD700;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      left: ${event.clientX}px;
      top: ${event.clientY}px;
      animation: particle 1s ease-out forwards;
    `;
    document.body.appendChild(particle);
    
    // –£–¥–∞–ª—è–µ–º –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
    setTimeout(() => particle.remove(), 1000);
  }
  
  // CSS –∞–Ω–∏–º–∞—Ü–∏—è
  if (!document.getElementById('particleCSS')) {
    const style = document.createElement('style');
    style.id = 'particleCSS';
    style.textContent = `
      @keyframes particle {
        to {
          transform: translateY(-100px) scale(0);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
  }
}

// ========== –°–ò–°–¢–ï–ú–ê –ù–ê–°–¢–†–û–ï–ö ==========

function showSettings() {
  const html = `
    <div style="background: #1a1a1a; padding: 30px; border-radius: 15px; max-width: 500px; margin: 0 auto;">
      <h2 style="color: #FFD700; margin-bottom: 20px;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
      
      <div style="margin: 20px 0;">
        <label style="display: flex; justify-content: space-between; align-items: center;">
          <span>–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</span>
          <div class="toggle-switch ${GAME.settings.autoSave ? 'active' : ''}" onclick="toggleSetting('autoSave')"></div>
        </label>
      </div>
      
      <div style="margin: 20px 0;">
        <label style="display: flex; justify-content: space-between; align-items: center;">
          <span>–ß–∞—Å—Ç–∏—Ü—ã –∫–ª–∏–∫–∞</span>
          <div class="toggle-switch ${GAME.settings.particles ? 'active' : ''}" onclick="toggleSetting('particles')"></div>
        </label>
      </div>
      
      <div style="margin: 20px 0;">
        <label style="display: flex; justify-content: space-between; align-items: center;">
          <span>–ó–≤—É–∫–∏</span>
          <div class="toggle-switch ${GAME.settings.sound ? 'active' : ''}" onclick="toggleSetting('sound')"></div>
        </label>
      </div>
      
      <div style="margin: 20px 0;">
        <label style="display: flex; justify-content: space-between; align-items: center;">
          <span>–¢–µ–º–Ω—ã–π —Ä–µ–∂–∏–º</span>
          <div class="toggle-switch ${GAME.settings.darkMode ? 'active' : ''}" onclick="toggleSetting('darkMode')"></div>
        </label>
      </div>
      
      <button class="btn" onclick="closeSettings()" style="width: 100%; margin-top: 20px;">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  `;
  
  // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
  const modal = document.createElement('div');
  modal.id = 'settingsModal';
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  `;
  modal.innerHTML = html;
  document.body.appendChild(modal);
}

function closeSettings() {
  const modal = document.getElementById('settingsModal');
  if (modal) modal.remove();
}

function toggleSetting(setting) {
  GAME.settings[setting] = !GAME.settings[setting];
  saveGame();
  
  // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
  const toggle = event.target;
  toggle.classList.toggle('active');
  
  // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
  if (setting === 'particles') {
    if (GAME.settings.particles) {
      addEvent('‚ú® –ß–∞—Å—Ç–∏—Ü—ã –≤–∫–ª—é—á–µ–Ω—ã!', 'success');
    } else {
      addEvent('‚ùå –ß–∞—Å—Ç–∏—Ü—ã –≤—ã–∫–ª—é—á–µ–Ω—ã', 'neutral');
    }
  }
}

// ========== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–ò–ß–ò ==========

// 1. –°–∏—Å—Ç–µ–º–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
const ACHIEVEMENTS = {
  firstVideo: { name: '–ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ', desc: '–°–Ω—è—Ç–æ –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ', icon: 'üé¨', reward: 100 },
  viral10k: { name: '–í–∏—Ä—É—Å 10–ö', desc: '–í–∏–¥–µ–æ –Ω–∞–±—Ä–∞–ª–æ 10–ö –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤', icon: 'üî•', reward: 1000 },
  millionSubs: { name: '–ú–∏–ª–ª–∏–æ–Ω–Ω–∏–∫', desc: '1 000 000 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤', icon: 'ü•á', reward: 100000 },
  perfectQuality: { name: '–ò–¥–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ', desc: '–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ 10.0', icon: '‚≠ê', reward: 50000 },
  noSleep: { name: '–ë–µ–∑ —Å–Ω–∞', desc: '100 –≤–∏–¥–µ–æ –±–µ–∑ –æ—Ç–¥—ã—Ö–∞', icon: 'üò¥', reward: 25000 },
  sponsorKing: { name: '–ö–æ—Ä–æ–ª—å —Å–ø–æ–Ω—Å–æ—Ä–æ–≤', desc: '5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤', icon: 'üí∞', reward: 50000 }
};

function checkAchievements() {
  // –ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ
  if (GAME.totalVideos >= 1 && !GAME.achievements?.firstVideo) {
    unlockAchievement('firstVideo');
  }
  
  // –í–∏—Ä—É—Å 10–ö
  if (GAME.oldVideos.some(v => v.views >= 10000) && !GAME.achievements?.viral10k) {
    unlockAchievement('viral10k');
  }
  
  // –ò–¥–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
  if (GAME.quality >= 10 && !GAME.achievements?.perfectQuality) {
    unlockAchievement('perfectQuality');
  }
  
  // –ú–∏–ª–ª–∏–æ–Ω–Ω–∏–∫
  if (GAME.subscribers >= 1000000 && !GAME.achievements?.millionSubs) {
    unlockAchievement('millionSubs');
  }
}

function unlockAchievement(id) {
  if (!GAME.achievements) GAME.achievements = {};
  if (GAME.achievements[id]) return;
  
  const ach = ACHIEVEMENTS[id];
  GAME.achievements[id] = true;
  GAME.money += ach.reward;
  
  addEvent(`üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${ach.name}! ${ach.icon} +${ach.reward}‚ÇΩ`, 'viral');
  
  // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ø-–∞–ø
  showAchievementPopup(ach);
}

function showAchievementPopup(achievement) {
  const popup = document.createElement('div');
  popup.style.cssText = `
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #FFD700, #FFA500);
    color: #000;
    padding: 30px 50px;
    border-radius: 20px;
    text-align: center;
    z-index: 10000;
    animation: popIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-shadow: 0 0 50px rgba(255,215,0,0.8);
  `;
  popup.innerHTML = `
    <div style="font-size: 60px; margin-bottom: 10px;">${achievement.icon}</div>
    <h2 style="margin: 0;">${achievement.name}</h2>
    <p style="margin: 5px 0;">${achievement.desc}</p>
    <strong style="color: #FF0000;">+${format(achievement.reward)}‚ÇΩ</strong>
  `;
  
  document.body.appendChild(popup);
  
  // CSS –∞–Ω–∏–º–∞—Ü–∏—è
  if (!document.getElementById('achievementCSS')) {
    const style = document.createElement('style');
    style.textContent = `
      @keyframes popIn {
        0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        60% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(1); }
      }
    `;
    document.head.appendChild(style);
  }
  
  setTimeout(() => popup.remove(), 3000);
}

// 2. –°–∏—Å—Ç–µ–º–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
function spawnUniqueEvent() {
  const events = [
    {
      id: 'viral_collab',
      name: '–ú–µ–≥–∞-–∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—è',
      desc: '–í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª –∫–∞–Ω–∞–ª —Å 10–ú –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤!',
      requirement: () => GAME.subscribers >= 50000,
      effect: () => {
        GAME.subscribers += Math.floor(GAME.subscribers * 0.5);
        GAME.money += 50000;
        GAME.reputation += 20;
      },
      icon: 'ü§ù',
      rarity: 0.001 // 0.1% —à–∞–Ω—Å
    },
    {
      id: 'netflix_deal',
      name: 'Netflix –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç',
      desc: '–í–∞—à –∫–æ–Ω—Ç–µ–Ω—Ç —Ö–æ—Ç—è—Ç –∫—É–ø–∏—Ç—å –¥–ª—è —Å–µ—Ä–∏–∞–ª–∞!',
      requirement: () => GAME.quality >= 8 && GAME.subscribers >= 100000,
      effect: () => {
        GAME.money += 200000;
        GAME.reputation += 50;
      },
      icon: 'üì∫',
      rarity: 0.0005 // 0.05% —à–∞–Ω—Å
    },
    {
      id: 'super_viral',
      name: '–°–£–ü–ï–† –í–ò–†–ê–õ',
      desc: '–í–∞—à–µ –≤–∏–¥–µ–æ –≤–∑–æ—Ä–≤–∞–ª–æ –≤–µ—Å—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!',
      requirement: () => GAME.subscribers >= 1000000,
      effect: () => {
        GAME.subscribers *= 2;
        GAME.views *= 5;
        GAME.money *= 3;
      },
      icon: 'üí•',
      rarity: 0.0001 // 0.01% —à–∞–Ω—Å
    }
  ];
  
  events.forEach(event => {
    if (Math.random() < event.rarity && event.requirement() && !GAME.uniqueEvents?.[event.id]) {
      if (!GAME.uniqueEvents) GAME.uniqueEvents = {};
      GAME.uniqueEvents[event.id] = true;
      
      event.effect();
      
      // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      showSpecialEvent(event);
      
      // –î–æ–±–∞–≤–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
      addEvent(`üåü –£–ù–ò–ö–ê–õ–¨–ù–û–ï –°–û–ë–´–¢–ò–ï: ${event.name}! ${event.icon}`, 'viral');
    }
  });
}

function showSpecialEvent(event) {
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
  `;
  
  modal.innerHTML = `
    <div style="background: linear-gradient(135deg, #FF00FF, #FFD700); color: #000; padding: 50px; border-radius: 30px; text-align: center; max-width: 600px;">
      <div style="font-size: 100px; margin-bottom: 20px;">${event.icon}</div>
      <h1 style="font-size: 36px; margin: 0;">${event.name}</h1>
      <p style="font-size: 18px; margin: 10px 0;">${event.desc}</p>
      <button onclick="this.parentElement.parentElement.remove()" style="background: #000; color: white; border: none; padding: 15px 30px; border-radius: 15px; font-size: 18px; cursor: pointer; margin-top: 20px;">
        –ü–†–ò–ù–Ø–¢–¨ –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï
      </button>
    </div>
  `;
  
  document.body.appendChild(modal);
  
  // –£–±–∏—Ä–∞–µ–º —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
  setTimeout(() => modal.remove(), 10000);
}

// 3. –°–∏—Å—Ç–µ–º–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –∞–ø–≥—Ä–µ–π–¥—ã)
const LEGENDARY_ITEMS = {
  goldenMic: {
    name: 'üèÜ –ó–æ–ª–æ—Ç–æ–π –º–∏–∫—Ä–æ—Ñ–æ–Ω',
    desc: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–∏–∫—Ä–æ—Ñ–æ–Ω —Å –º–∞–≥–∏—á–µ—Å–∫–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏',
    effect: () => {
      STATE.quality += 10;
      STATE.income += 1000;
      STATE.vibe = 100;
    },
    requirement: () => STATE.prestigePoints >= 10,
    cost: 1000000,
    rarity: 'legendary'
  },
  diamondCamera: {
    name: 'üíé –ê–ª–º–∞–∑–Ω–∞—è –∫–∞–º–µ—Ä–∞',
    desc: '–ö–∞–º–µ—Ä–∞, —Å–ø–æ—Å–æ–±–Ω–∞—è —Å–Ω–∏–º–∞—Ç—å –≤ 8K —Å –∏–¥–µ–∞–ª—å–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º',
    effect: () => {
      STATE.quality += 15;
      STATE.income += 2000;
      STATE.reputation += 50;
    },
    requirement: () => STATE.awards.diamond,
    cost: 5000000,
    rarity: 'legendary'
  },
  infinityStudio: {
    name: '‚ôæÔ∏è –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —Å—Ç—É–¥–∏—è',
    desc: '–°—Ç—É–¥–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ —Å–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç',
    effect: () => {
      STATE.income += 10000;
      STATE.energy = 100;
      STATE.vibe = 100;
    },
    requirement: () => STATE.prestigePoints >= 50,
    cost: 50000000,
    rarity: 'mythic'
  }
};

function initLegendaryShop() {
  const shop = document.createElement('div');
  shop.id = 'legendaryShop';
  shop.style.cssText = `
    background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
    padding: 30px;
    border-radius: 20px;
    margin: 30px 0;
    border: 3px solid #FFD700;
    box-shadow: 0 0 30px rgba(255,215,0,0.3);
  `;
  
  shop.innerHTML = `
    <h2 style="color: #FFD700; text-align: center; margin-bottom: 20px;">üèÜ –õ–ï–ì–ï–ù–î–ê–†–ù–´–ô –ú–ê–ì–ê–ó–ò–ù</h2>
    <div id="legendaryItems"></div>
  `;
  
  // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü –∞–ø–≥—Ä–µ–π–¥–æ–≤
  document.getElementById('upgradesTab').appendChild(shop);
  
  renderLegendaryItems();
}

function renderLegendaryItems() {
  const container = document.getElementById('legendaryItems');
  if (!container) return;
  
  container.innerHTML = '';
  
  Object.entries(LEGENDARY_ITEMS).forEach(([key, item]) => {
    const canBuy = item.requirement() && STATE.money >= item.cost && !STATE.legendaryItems?.[key];
    
    const card = document.createElement('div');
    card.className = 'upgrade-card';
    card.style.cssText = `
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #000;
      border: 3px solid #FFD700;
      box-shadow: 0 0 20px rgba(255,215,0,0.5);
    `;
    
    card.innerHTML = `
      <div class="upgrade-name">${item.name}</div>
      <div class="upgrade-desc">${item.desc}</div>
      <div class="upgrade-stats">
        –°—Ç–æ–∏–º–æ—Å—Ç—å: ${format(item.cost)}‚ÇΩ<br>
        –†–µ–¥–∫–æ—Å—Ç—å: ${item.rarity.toUpperCase()}
      </div>
      <button class="upgrade-btn" onclick="buyLegendaryItem('${key}')" ${!canBuy ? 'disabled' : ''}>
        ${!canBuy ? (STATE.legendaryItems?.[key] ? '–ö–£–ü–õ–ï–ù–û' : '–ù–ï–î–û–°–¢–£–ü–ù–û') : `–ö–£–ü–ò–¢–¨ ${format(item.cost)}‚ÇΩ`}
      </button>
    `;
    
    container.appendChild(card);
  });
}

function buyLegendaryItem(key) {
  const item = LEGENDARY_ITEMS[key];
  if (!item.requirement() || STATE.money < item.cost || STATE.legendaryItems?.[key]) return;
  
  STATE.money -= item.cost;
  if (!STATE.legendaryItems) STATE.legendaryItems = {};
  STATE.legendaryItems[key] = true;
  
  item.effect();
  
  addEvent(`üåü –õ–ï–ì–ï–ù–î–ê–†–ù–´–ô –ü–†–ï–î–ú–ï–¢: ${item.name}!`, 'viral');
  addEvent(`üí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: ${format(item.cost)}‚ÇΩ`, 'money');
  
  renderLegendaryItems();
  updateDashboard();
  saveGame();
}

// ========== –§–ò–ù–ê–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========

// –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –¥–ª—è onclick
window.createChannel = createChannel;
window.selectNiche = (niche) => { 
  document.querySelectorAll('.niche-card').forEach(c => c.classList.remove('selected'));
  event.target.closest('.niche-card').classList.add('selected');
  GAME.niche = niche;
};

// –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å—ë
window.addEventListener('DOMContentLoaded', () => {
  init();
  initClickSystem();
  initLegendaryShop();
  initAchievementSystem();
  
  // –ë–æ–Ω—É—Å: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
  if (loadGame() && GAME.name) {
    showScreen('gameScreen');
    updateAllUI();
  }
});
    </script>
</body>
</html>
